<!DOCTYPE index.html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>DualPay Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@700&family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: { 'app-yellow': '#FFFDE7', 'app-red': '#FF5252', 'app-green': '#2E7D32' },
                    fontFamily: { header: ['Comfortaa', 'cursive'], data: ['Montserrat', 'sans-serif'] }
                }
            }
        }
    </script>
    <style>
        body { background-color: #FFFDE7; overflow-x: hidden; touch-action: manipulation; font-family: 'Montserrat', sans-serif; }
        .bg-pattern { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; display: grid; grid-template-columns: repeat(6, 1fr); opacity: 0.1; pointer-events: none; }
        .symbol { display: flex; justify-content: center; align-items: center; animation: float 10s infinite ease-in-out; font-size: 20px; }
        @keyframes float { 0%, 100% { transform: translateY(0) rotate(0); } 50% { transform: translateY(-20px) rotate(10deg); } }
        .glass { background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border: 1px solid white; box-shadow: 0 20px 40px rgba(0,0,0,0.1); }
        .input-red { background-color: #FF5252; color: white; border: none; }
        .input-red::placeholder { color: rgba(255,255,255,0.6); }
        input::-webkit-outer-spin-button, input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">
    <div id="bg-pattern" class="bg-pattern"></div>

    <main class="glass w-full max-w-sm rounded-[2.5rem] p-6 flex flex-col gap-5">
        <div class="flex flex-col items-center gap-2">
            <div class="bg-app-green w-14 h-14 rounded-2xl flex items-center justify-center shadow-lg">
                <span class="font-header text-white text-lg">€ лв</span>
            </div>
            <h1 class="font-header text-xl text-gray-800">DualPay</h1>
        </div>

        <div class="space-y-4">
            <div>
                <label class="text-[10px] font-bold text-gray-400 uppercase ml-2">Сума за плащане</label>
                <div class="flex gap-2">
                    <input type="number" id="billAmount" placeholder="0.00" class="input-red w-full p-4 rounded-2xl font-data text-xl font-bold outline-none">
                    <select id="billCurrency" class="bg-white p-4 rounded-2xl font-header text-xs shadow-sm border border-gray-100">
                        <option value="BGN">лв</option>
                        <option value="EUR">€</option>
                    </select>
                </div>
            </div>

            <div class="grid grid-cols-2 gap-3">
                <div>
                    <label class="text-[10px] font-bold text-gray-400 uppercase ml-2">Платено лв</label>
                    <input type="number" id="paidBGN" placeholder="0.00" class="bg-white w-full p-4 rounded-2xl font-data text-lg border border-gray-100 outline-none focus:ring-2 ring-app-red/20">
                </div>
                <div>
                    <label class="text-[10px] font-bold text-gray-400 uppercase ml-2">Платено €</label>
                    <input type="number" id="paidEUR" placeholder="0.00" class="bg-white w-full p-4 rounded-2xl font-data text-lg border border-gray-100 outline-none focus:ring-2 ring-app-red/20">
                </div>
            </div>
        </div>

        <div id="errorBox" class="hidden bg-red-50 text-app-red p-3 rounded-xl text-center text-xs font-bold border border-red-100">
            ⚠ Недостатъчна сума!
        </div>

        <div id="resultArea" class="hidden border-t border-gray-100 pt-4 space-y-4">
            <div class="flex bg-gray-100/50 p-1 rounded-xl">
                <button onclick="setCurrency('BGN')" id="btnBGN" class="flex-1 py-2 rounded-lg font-header text-[10px] bg-app-red text-white shadow-md transition-all">В ЛЕВА</button>
                <button onclick="setCurrency('EUR')" id="btnEUR" class="flex-1 py-2 rounded-lg font-header text-[10px] transition-all">В ЕВРО</button>
            </div>
            <div class="text-center">
                <h2 id="mainChange" class="font-data text-4xl font-bold text-gray-800">0.00 лв</h2>
                <p id="secondaryChange" class="font-data text-xs text-gray-400 mt-1">0.00 €</p>
            </div>
        </div>

        <footer class="text-center space-y-1 mt-2">
            <p class="text-[9px] font-bold text-gray-400 uppercase">Курс: 1 EUR = 1.95583 BGN</p>
            <p class="text-[10px] text-gray-500 font-medium italic">© Цветелина Терзиева</p>
        </footer>
    </main>

    <script>
        const RATE = 1.95583;
        let viewCurrency = 'BGN';

        // Background
        const bg = document.getElementById('bg-pattern');
        for(let i=0; i<24; i++) {
            const el = document.createElement('div');
            el.className = 'symbol font-bold text-gray-300';
            el.innerText = i % 2 === 0 ? '€' : 'лв';
            el.style.animationDelay = Math.random() * 5 + 's';
            bg.appendChild(el);
        }

        function setCurrency(c) {
            viewCurrency = c;
            document.getElementById('btnBGN').className = c === 'BGN' ? 'flex-1 py-2 rounded-lg font-header text-[10px] bg-app-red text-white shadow-md' : 'flex-1 py-2 rounded-lg font-header text-[10px]';
            document.getElementById('btnEUR').className = c === 'EUR' ? 'flex-1 py-2 rounded-lg font-header text-[10px] bg-app-red text-white shadow-md' : 'flex-1 py-2 rounded-lg font-header text-[10px]';
            calculate();
        }

        function calculate() {
            const bill = parseFloat(document.getElementById('billAmount').value) || 0;
            const billCurr = document.getElementById('billCurrency').value;
            const pBGN = parseFloat(document.getElementById('paidBGN').value) || 0;
            const pEUR = parseFloat(document.getElementById('paidEUR').value) || 0;

            const billInBGN = billCurr === 'EUR' ? bill * RATE : bill;
            const totalPaidInBGN = pBGN + (pEUR * RATE);
            
            const resArea = document.getElementById('resultArea');
            const errBox = document.getElementById('errorBox');

            // Показвай резултат само ако е въведена сума за плащане
            if (bill > 0) {
                if (totalPaidInBGN < (billInBGN - 0.001)) { // Малък толеранс за закръгляне
                    errBox.classList.remove('hidden');
                    resArea.classList.add('hidden');
                } else {
                    errBox.classList.add('hidden');
                    resArea.classList.remove('hidden');
                    
                    const changeInBGN = totalPaidInBGN - billInBGN;
                    const changeInEUR = changeInBGN / RATE;

                    if (viewCurrency === 'BGN') {
                        document.getElementById('mainChange').innerText = changeInBGN.toFixed(2) + ' лв';
                        document.getElementById('secondaryChange').innerText = '≈ ' + changeInEUR.toFixed(2) + ' €';
                    } else {
                        document.getElementById('mainChange').innerText = changeInEUR.toFixed(2) + ' €';
                        document.getElementById('secondaryChange').innerText = '≈ ' + changeInBGN.toFixed(2) + ' лв';
                    }
                }
            } else {
                resArea.classList.add('hidden');
                errBox.classList.add('hidden');
            }
        }

        // Слушатели за всички видове промени
        ['input', 'change', 'keyup'].forEach(evt => {
            document.getElementById('billAmount').addEventListener(evt, calculate);
            document.getElementById('paidBGN').addEventListener(evt, calculate);
            document.getElementById('paidEUR').addEventListener(evt, calculate);
        });
        document.getElementById('billCurrency').addEventListener('change', calculate);

    </script>
</body>
</html>